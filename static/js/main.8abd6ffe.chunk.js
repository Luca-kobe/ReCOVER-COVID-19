(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{1003:function(e,t,a){},1006:function(e,t,a){},1019:function(e,t,a){},1020:function(e,t,a){e.exports=a.p+"static/media/nyt_graph.b82f8664.png"},1021:function(e,t,a){e.exports=a.p+"static/media/jhu_graph.39518de8.png"},1022:function(e,t,a){e.exports=a.p+"static/media/usf_graph.35c9b379.png"},1030:function(e,t){},1032:function(e,t){},1033:function(e,t){},1034:function(e,t){},1035:function(e,t){},1067:function(e,t,a){},1083:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),i=a(44),o=a.n(i),s=(a(679),a(43)),c=a(42),l=a(67),u=a(66),d=(a(680),a(462)),m=(a(468),a(375)),h=(a(303),a(112)),p=(a(469),a(108)),f=(a(305),a(84)),v=(a(685),a(203)),g=(a(470),a(379)),b=(a(689),a(163)),y=(a(471),a(107)),S=(a(472),a(380)),E=(a(394),a(198)),k=a(179),D=a(140),w=a(159),C=a(54),_=(a(395),a(121)),O=a(75),M=a(358),I=a(160),j=a.n(I),x=a(220),A=a.n(x),N=a(51);var R=function(e){var t=e.series,a=e.lineGenerator,r=e.xScale,i=e.yScale;return t.map((function(e){var t=e.id,o=e.data,s=e.color,c=e.predicted,l=e.distancing,u={strokeWidth:3};return c&&(u.strokeDasharray=l?"6, 4":"2, 6"),n.a.createElement("path",{key:t,d:a(o.map((function(e){return{x:r(e.data.x),y:i(e.data.y)}}))),fill:"none",stroke:s,style:u})}))},T={axis:{ticks:{text:{fontSize:18}},legend:{text:{fontSize:18}}},legends:{text:{fontSize:18}}},P=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"parseDate",value:function(e){var t=e.split("-").map(Number),a=Object(O.a)(t,3),r=a[0],n=a[1],i=a[2];return new Date(r,n-=1,i)}},{key:"getCumulativeData",value:function(e){var t=this;return e.map((function(e){return{x:t.parseDate(e.date),y:e.value}}))}},{key:"getDeltaData",value:function(e,t){var a=this;return e.map((function(r,n){return 0===n?{x:a.parseDate(r.date),y:r.value-t}:{x:a.parseDate(r.date),y:r.value-e[n-1].value}}))}},{key:"processData",value:function(e,t){var a=t.statistic,r=t.yScale,n=t.initialVal,i="delta"===a?this.getDeltaData(e,n):this.getCumulativeData(e);return"log"===r&&(i=i.filter((function(e){e.x;return e.y>0}))),i}},{key:"getDataMax",value:function(){var e=this.props.data,t=0;return Object.keys(e).forEach((function(a){var r=e[a],n=r.observed,i=r.predictions;t=Math.max(t,Math.max.apply(Math,Object(w.a)(n.map((function(e){return e.value}))))),i.forEach((function(e){var a=e.time_series;t=Math.max(t,Math.max.apply(Math,Object(w.a)(a.map((function(e){return e.value})))))}))})),t}},{key:"getYAxisProps",value:function(){for(var e=this.props,t=e.statistic,a=e.yScale,r={format:function(e){return A()(e).format("0.[0]a")},orient:"left",tickSize:5,tickPadding:5,tickRotation:0,legend:"delta"===t?"New Cases":"Cumulative Cases",legendOffset:-60,legendPosition:"middle"},n=[],i=0;i<=Math.ceil(Math.log10(this.getDataMax()));i++)n.push(Math.pow(10,i));var o=Object(D.a)({},r,{tickValues:n});return"log"===a?{axisLeft:o,gridYValues:n,yScale:{type:"log",base:10,min:Math.min.apply(Math,n),max:Math.max.apply(Math,n)}}:{axisLeft:r,yScale:{type:"linear",min:"auto",max:"auto"}}}},{key:"render",value:function(){var e=this,t=this.props.data,a=this.props,r=a.statistic,i=a.yScale,o=a.dataType,s=[],c=[];Object.keys(t).sort().forEach((function(a,n){var l=function(e){var t=[N.red,N.gold,N.green,N.blue,N.volcano,N.yellow,N.cyan,N.purple,N.organge,N.lime,N.geekblue,N.magenta];return t[e%t.length]}(n),u=t[a].observed,d=t[a].observed_deaths;o.includes("confirmed")&&(s.push({id:a,data:e.processData(u,{statistic:r,yScale:i,initialVal:0}),predicted:!1}),c.push(l[4])),o.includes("death")&&(s.push({id:"".concat(a," death"),data:e.processData(d,{statistic:r,yScale:i,initialVal:0}),predicted:!1}),c.push(l[6])),t[a].predictions.filter((function(e){return e.time_series.length>0})).forEach((function(t,n){var m=t.model.name,h="SI-kJalpha"!==m.substring(0,10)||m.includes("death prediction"),p=t.distancing,f=t.time_series,v=[];if(o.includes("death")&&h)v=[d[d.length-1]].concat(f);else{if(!o.includes("confirmed")||h)return;v=[u[u.length-1]].concat(f)}s.push({id:"".concat(a," (").concat(m,", ").concat(p,")"),data:e.processData(v,{statistic:r,yScale:i,initialVal:h?d[d.length-2].value:u[u.length-2].value}),predicted:!0,distancing:p}),n<=4?c.push(l[4+n]):n<=8?c.push(l[8-n]):c.push(l[n%10])}))}));var l="every week";if(s.length>0){var u=s[0].data[0].x,d=s[0].data[0].x;s.forEach((function(e){e.data.forEach((function(e){var t=e.x;u=Math.min(u,t),d=Math.max(d,t)}))})),u=j()(u),(d=j()(d)).diff(u,"days")>150&&(l="every month")}return n.a.createElement(M.a,Object.assign({data:s,colors:c,margin:{top:10,right:50,bottom:70,left:100},xScale:{type:"time",format:"native",precision:"day"},axisBottom:{tickValues:l,format:function(e){return j()(e).format("M/D")},orient:"bottom",tickSize:5,tickPadding:5,tickRotation:0,legend:"Date",legendOffset:36,legendPosition:"middle"}},this.getYAxisProps(),{enableSlices:"x",sliceTooltip:function(e){var t=e.slice;return n.a.createElement("div",{style:{background:"white",padding:"9px 12px",border:"1px solid #ccc"}},n.a.createElement("div",null,j()(t.points[0].data.x).format("MMM Do YYYY")),t.points.map((function(e){return n.a.createElement("div",{key:e.id,style:{color:e.serieColor,padding:"3px 0"}},n.a.createElement("strong",null,e.serieId),"[",A()(e.data.yFormatted).format("0.[0]a"),"]")})))},pointSize:0,pointLabel:"y",pointLabelYOffset:-12,legends:[{anchor:"top-left",direction:"column",justify:!1,translateX:0,translateY:0,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.75,symbolSize:12,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .5)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .03)",itemOpacity:1}}]}],layers:["grid","markers","areas","crosshair",R,"slices","points","axes","legends"],theme:T}))}}]),a}(r.Component),V=a(85),F=a.n(V),L="https://dslab-covid19-backend.herokuapp.com/api",G=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,[{key:"affected_by",value:function(e){}},{key:"areas",value:function(e){var t="".concat(L,"/areas");F.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"models",value:function(e){var t="".concat(L,"/models");F.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"infection_models",value:function(e){var t="".concat(L,"/infection_models");F.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"death_models",value:function(e){var t="".concat(L,"/death_models");F.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"cumulative_infections",value:function(e){var t="".concat(L,"/cumulative_infections");F.a.get(t).then((function(t){return e(t.data)}))}},{key:"predict_all",value:function(e,t){var a="".concat(L,"/predict_all");F.a.get(a,{params:e}).then((function(e){return t(e.data)}))}},{key:"predict",value:function(e,t){var a="".concat(L,"/predict");F.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"getCurrentDate",value:function(e){var t="".concat(L,"/current_date");F.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"checkHistory",value:function(e,t){var a="".concat(L,"/check_history");F.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"history_cumulative",value:function(e,t){var a="".concat(L,"/history_cumulative");F.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"scores_all",value:function(e,t){var a="".concat(L,"/scores_all");F.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"scores",value:function(e,t){var a="".concat(L,"/scores");F.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"latest_score_date",value:function(e){var t="".concat(L,"/latest_score_date");F.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"cumulative_death",value:function(e,t){var a="".concat(L,"/cumulative_death");F.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"all_mrf_scores",value:function(e,t){var a="".concat(L,"/all_mrf_scores");F.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"real_time",value:function(e){F.a.get("https://api.covid19api.com/summary").then((function(t){var a=t.data.Global.TotalConfirmed,r=t.data.Global.TotalDeaths;e({totalConfirmed:a,totalDeaths:r})}))}},{key:"get_maximum",value:function(e){var t="".concat(L,"/get_maximum");F.a.get(t).then((function(t){var a={max_val:t.data[0].max_val,max_death_val:t.data[0].max_death_val};e(a)}))}}]),e}();function B(e){return"".concat(e.country).concat(e.state?" / "+e.state:"")}function W(e){var t=e.split("/");return{country:t[0].trim(),state:2===t.length?t[1].trim():""}}var H=a(37),z=a(99),U=(a(1082),a(366)),Y=a(367),J=a(582),q=a(583),K=a(584),X=a(382);H.e(X.a);var Q=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.call(this)).onShowState=function(t){e.setState({showState:t})},e.modelAPI=new G,e.state={areasList:[],showState:!1,worldSeries:{},usaSeries:{},chinaSeries:{},canadaSeries:{},austriliaSeries:{}},e.modelAPI.areas((function(t){return e.setState({areasList:t})})),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.triggerRef(this),this.fetchData(this.props.dynamicMapOn)}},{key:"fetchData",value:function(e){var t=this;!e||""===this.props.confirmed_model&&""===this.props.death_model?"confirmed"===this.props.dataType?this.modelAPI.cumulative_infections((function(e){var a=e.map((function(e){return{id:e.area.iso_2,value:Math.log(e.max_percentage),valueTrue:e.value,area:e.area}}));t.setState({heatmapData:a},t.initChart)})):this.modelAPI.cumulative_death({days:0},(function(e){var a=e.map((function(e){return{id:e.area.iso_2,value:Math.log(e.max_percentage),valueTrue:e.value,area:e.area}}));t.setState({heatmapData:a},t.resetChart)})):"cumulative"===this.props.statistic?this.props.days>0?this.modelAPI.predict_all({days:this.props.days,model:"confirmed"===this.props.dataType?this.props.confirmed_model:this.props.death_model},(function(e){var a=e.map((function(e){return{id:e.area.iso_2,value:"confirmed"===t.props.dataType?Math.log(e.max_val_percentage):Math.log(e.max_death_percentage),valueTrue:e.value,area:e.area}}));t.setState({heatmapData:a},t.resetChart)})):this.modelAPI.history_cumulative({days:this.props.days},(function(e){var a=e.map((function(e){return"confirmed"===t.props.dataType?{id:e.area.iso_2,value:Math.log(e.max_val_percentage),valueTrue:e.value,area:e.area}:{id:e.area.iso_2,value:Math.log(e.max_death_percentage),valueTrue:e.deathValue,area:e.area}}));t.setState({heatmapData:a},t.resetChart)})):this.props.days>0?this.modelAPI.predict_all({days:this.props.days,model:"confirmed"===this.props.dataType?this.props.confirmed_model:this.props.death_model},(function(e){t.props.days>7?t.modelAPI.predict_all({days:t.props.days-7,model:"confirmed"===t.props.dataType?t.props.confirmed_model:t.props.death_model},(function(a){var r=e.map((function(e,t){return{id:e.area.iso_2,value:e.value-a[t].value>0?Math.log(e.value-a[t].value):0,valueTrue:e.value-a[t].value>0?e.value-a[t].value:0,area:e.area}}));t.setState({heatmapData:r},t.resetChart)})):t.modelAPI.history_cumulative({days:t.props.days-7},(function(a){var r=e.map((function(e,r){return"confirmed"===t.props.dataType?{id:e.area.iso_2,value:e.value-a.find((function(t){return t.area.iso_2===e.area.iso_2})).value>0?Math.log(e.value-a.find((function(t){return t.area.iso_2===e.area.iso_2})).value):0,valueTrue:e.value-a.find((function(t){return t.area.iso_2===e.area.iso_2})).value>0?e.value-a.find((function(t){return t.area.iso_2===e.area.iso_2})).value:0,area:e.area}:{id:e.area.iso_2,value:e.deathValue-a.find((function(t){return t.area.iso_2===e.area.iso_2})).deathValue>0?Math.log(e.deathValue-a.find((function(t){return t.area.iso_2===e.area.iso_2})).deathValue):0,valueTrue:e.deathValue-a.find((function(t){return t.area.iso_2===e.area.iso_2})).deathValue>0?e.deathValue-a.find((function(t){return t.area.iso_2===e.area.iso_2})).deathValue:0,area:e.area}}));t.setState({heatmapData:r},t.resetChart)}))})):this.modelAPI.history_cumulative({days:this.props.days},(function(e){t.modelAPI.history_cumulative({days:t.props.days-7},(function(a){var r=e.map((function(e,r){return"confirmed"===t.props.dataType?{id:e.area.iso_2,value:e.value-a[r].value>0?Math.log(e.value-a[r].value):0,valueTrue:e.value-a[r].value>0?e.value-a[r].value:0,area:e.area}:{id:e.area.iso_2,value:e.deathValue-a[r].deathValue>0?Math.log(e.deathValue-a[r].deathValue):0,valueTrue:e.deathValue-a[r].deathValue>0?e.deathValue-a[r].deathValue:0,area:e.area}}));t.setState({heatmapData:r},t.resetChart)}))}))}},{key:"initChart",value:function(){this.chart=H.d("chartdiv",z.a),this.chart.projection=new z.d.Mercator;var e=this.chart.series.push(new z.b);e=this.createChartSeries(e,{geodata:U.a,exclude:["AQ"],data:this.state.heatmapData});var t=this.chart.series.push(new z.b);t=this.createChartSeries(t,{geodata:J.a,data:this.state.heatmapData,disabled:!this.state.showState});var a=this.chart.series.push(new z.b);a=this.createChartSeries(a,{geodata:Y.a,data:this.state.heatmapData,disabled:!this.state.showState});var r=this.chart.series.push(new z.b);r=this.createChartSeries(r,{geodata:q.a,data:this.state.heatmapData,disabled:!this.state.showState});var n=this.chart.series.push(new z.b);n=this.createChartSeries(n,{geodata:K.a,data:this.state.heatmapData,disabled:!this.state.showState}),this.stateSeries=[a],this.initChartInterface(),this.setState({worldSeries:e,chinaSeries:t,usaSeries:a,canadaSeries:r,australiaSeries:n})}},{key:"createChartSeries",value:function(e,t){var a=this.props.statistic,r=(e=Object.assign(e,t)).mapPolygons.template;"cumulative"===a?r.polygon.adapter.add("fill",(function(e,t){return t.dataItem?t.dataItem.value>=Math.log(9e3)?H.c("#140000"):t.dataItem.value>=Math.log(7e3)?H.c("#290000"):t.dataItem.value>=Math.log(4e3)?H.c("#3D0000"):t.dataItem.value>=Math.log(1e3)?H.c("#520000"):t.dataItem.value>=Math.log(750)?H.c("#660000"):t.dataItem.value>=Math.log(450)?H.c("#7A0000"):t.dataItem.value>=Math.log(340)?H.c("#8F0000"):t.dataItem.value>=Math.log(188)?H.c("#A30000"):t.dataItem.value>=Math.log(160)?H.c("#B80000"):t.dataItem.value>=Math.log(121)?H.c("#CC0000"):t.dataItem.value>=Math.log(104)?H.c("#E00000"):t.dataItem.value>=Math.log(93)?H.c("#F50000"):t.dataItem.value>=Math.log(80)?H.c("#FF0A0A"):t.dataItem.value>=Math.log(62)?H.c("#FF1F1F"):t.dataItem.value>=Math.log(49)?H.c("#FF3333"):t.dataItem.value>=Math.log(39)?H.c("#FF4747"):t.dataItem.value>=Math.log(28)?H.c("#FF5C5C"):t.dataItem.value>=Math.log(21)?H.c("#FF7070"):t.dataItem.value>=Math.log(10)?H.c("#FF8585"):t.dataItem.value>=Math.log(15)?H.c("#FF9999"):t.dataItem.value>=Math.log(12)?H.c("#FFADAD"):t.dataItem.value>=Math.log(9)?H.c("#FFC2CD"):t.dataItem.value>=Math.log(6)?H.c("#FFD6DE"):H.c("#FFEBEE"):e})):e.heatRules.push({property:"fill",target:r,min:H.c("#ffffff"),max:H.c("#000000"),minValue:0,maxValue:Math.log(1e4)}),r.tooltipText="{name}: {valueTrue}",r.nonScalingStroke=!0,r.strokeWidth=1,r.stroke=H.c("black"),r.states.create("hover").properties.fill=H.c("#e43027"),r.cursorOverStyle=H.b.pointer;var n=this.props,i=n.onMapClick,o=n.onNoData;return r.events.on("hit",(function(e){var t=e.target.dataItem.dataContext,a=(t.id,t.value,t.area),r=t.name;a?i(a):o(r)})),e}},{key:"initChartInterface",value:function(){var e=this,t=this.state.showState;this.chart.zoomControl=new z.c,this.chart.zoomControl.cursorOverStyle=H.b.pointer;var a=this.chart.chartContainer.createChild(H.a);a.label.text="".concat(t?"Hide":"Show"," States/Provinces"),a.togglable=!0,a.padding(5,5,5,5),a.align="right",a.marginRight=15,a.cursorOverStyle=H.b.pointer,a.events.on("hit",(function(){e.onShowState(a.isActive);var t=e.state.showState;e.stateSeries.forEach((function(e){e.disabled=!t})),a.label.text="".concat(t?"Hide":"Show"," States/Provinces")}))}},{key:"resetChart",value:function(){var e=this.state.worldSeries,t=this.state.usaSeries,a=this.state.chinaSeries,r=this.state.canadaSeries,n=this.state.austriliaSeries;e.data=this.state.heatmapData,t.data=this.state.heatmapData,r.data=this.state.heatmapData,a.data=this.state.heatmapData,n.data=this.state.heatmapData}},{key:"componentWillUnmount",value:function(){this.chart&&this.chart.dispose()}},{key:"render",value:function(){return n.a.createElement("div",{id:"chartdiv"})}}]),a}(r.Component),$=(a(834),_.a.Option),Z=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).handleYScaleSelect=function(e){r.setState({yScale:e.target.value})},r.handleStatisticSelect=function(e){r.setState({statistic:e.target.value},(function(){r.map.fetchData(r.state.dynamicMapOn)}))},r.handleDataTypeSelect=function(e){r.setState({dataType:e})},r.handleMapShownSelect=function(e){r.setState({mapShown:e.target.value},(function(){r.map.fetchData(r.state.dynamicMapOn)}))},r.componentWillMount=function(){r.addAreaByStr("US"),r.formRef=n.a.createRef(),r.modelAPI=new G,r.modelAPI.areas((function(e){return r.setState({areasList:e})})),r.modelAPI.infection_models((function(e){return r.setState({modelsList:e},(function(){r.modelAPI.death_models((function(e){for(var t=function(t){r.setState((function(a){return{modelsList:[].concat(Object(w.a)(a.modelsList),[e[t]])}}))},a=6;a<e.length;++a)t(a)}))}))})),r.modelAPI.getCurrentDate((function(e){return r.setState({currentDate:e[0].date,firstDate:e[0].firstDate})})),r.modelAPI.real_time((function(e){r.setState({totalConfirmed:e.totalConfirmed,totalDeaths:e.totalDeaths})})),r.modelAPI.get_maximum((function(e){r.setState({max_val:e.max_val,max_death_val:e.max_death_val})}))},r.bindRef=function(e){r.map=e},r.onAlertClose=function(){r.setState({noDataError:!1})},r.onNoData=function(e){r.setState({noDataError:!0,errorDescription:"There is currently no data for ".concat(e)})},r.generateMarks=function(){var e=r.state,t=e.currentDate,a=e.days,n=e.firstDate,i=new Date("".concat(t,"T00:00")),o=new Date("".concat(n,"T00:00"));i.setDate(i.getDate(Date)+a);var s={};s[a]="".concat(i.getMonth()+1,"/").concat(i.getDate());for(var c=a+7;c<a+50&&c<=99;)i.setDate(i.getDate()+7),s[c]="".concat(i.getMonth()+1,"/").concat(i.getDate()),c+=7;for((i=new Date("".concat(t,"T00:00"))).setDate(i.getDate(Date)+a),i.setDate(i.getDate()-7),c=a-7;i>=o&&c>a-30;)s[c]="".concat(i.getMonth()+1,"/").concat(i.getDate()),i.setDate(i.getDate()-7),c-=7;return s},r.getDaysToFirstDate=function(){var e=r.state,t=e.currentDate,a=e.firstDate,n=new Date("".concat(t,"T00:00")),i=new Date("".concat(a,"T00:00"));return Math.ceil(Math.abs(n-i)/864e5)},r.toggleControlInstructions=function(){var e=r.state.showControlInstructions;r.setState({showControlInstructions:!e})},r.toggleMapInstructions=function(){var e=r.state.showMapInstructions;r.setState({showMapInstructions:!e})},r.state={areas:r.props.areas||[],areasList:[],models:r.props.models||["SI-kJalpha - Default"],modelsList:[],currentDate:"",firstDate:"",current:!0,worst_effort:!1,best_effort:!1,mainGraphData:{},days:14,dynamicMapOn:!1,dataType:["confirmed"],statistic:"cumulative",mapShown:"confirmed",yScale:"linear",noDataError:!1,errorDescription:"",showControlInstructions:!1,showMapInstructions:!1,totalConfirmed:0,totalDeaths:0,max_val:0,max_death_val:0},r.addAreaByStr=r.addAreaByStr.bind(Object(C.a)(r)),r.removeAreaByStr=r.removeAreaByStr.bind(Object(C.a)(r)),r.onValuesChange=r.onValuesChange.bind(Object(C.a)(r)),r.onMapClick=r.onMapClick.bind(Object(C.a)(r)),r.onDaysToPredictChange=r.onDaysToPredictChange.bind(Object(C.a)(r)),r.switchDynamicMap=r.switchDynamicMap.bind(Object(C.a)(r)),r.onAlertClose=r.onAlertClose.bind(Object(C.a)(r)),r.onNoData=r.onNoData.bind(Object(C.a)(r)),r.generateMarks=r.generateMarks.bind(Object(C.a)(r)),r.handleDataTypeSelect=r.handleDataTypeSelect.bind(Object(C.a)(r)),r.handleStatisticSelect=r.handleStatisticSelect.bind(Object(C.a)(r)),r.handleYScaleSelect=r.handleYScaleSelect.bind(Object(C.a)(r)),r.toggleControlInstructions=r.toggleControlInstructions.bind(Object(C.a)(r)),r.toggleMapInstructions=r.toggleMapInstructions.bind(Object(C.a)(r)),r}return Object(c.a)(a,[{key:"onMapClick",value:function(e){this.areaIsSelected(e)||this.addAreaByStr(B(e))}},{key:"areaIsSelected",value:function(e){if(this.state.areas&&e){var t=B(e);return this.state.areas.includes(t)}return!1}},{key:"addAreaByStr",value:function(e){var t=this,a=W(e);this.setState((function(t){return{areas:[].concat(Object(w.a)(t.areas),[e])}}),(function(){t.state.days>=0?t.modelAPI.predict({state:a.state,country:a.country,models:t.state.models,days:t.state.days,current:t.state.current,worst_effort:t.state.worst_effort,best_effort:t.state.best_effort},(function(a){t.setState((function(t){return{mainGraphData:Object(D.a)({},t.mainGraphData,Object(k.a)({},e,a))}}))})):t.modelAPI.checkHistory({state:a.state,country:a.country,days:t.state.days},(function(a){t.setState((function(t){return{mainGraphData:Object(D.a)({},t.mainGraphData,Object(k.a)({},e,a))}}))})),t.formRef.current.setFieldsValue({areas:t.state.areas})}))}},{key:"removeAreaByStr",value:function(e){this.setState((function(t){return{areas:t.areas.filter((function(t){return t!==e})),mainGraphData:Object.keys(t.mainGraphData).filter((function(t){return t!==e})).reduce((function(e,a){return Object(D.a)({},e,Object(k.a)({},a,t.mainGraphData[a]))}),{})}}))}},{key:"modelIsSelected",value:function(e){if(this.state.models&&e){var t="".concat(e.name);return this.state.models.includes(t)}return!1}},{key:"onValuesChange",value:function(e,t){var a=this;this.state.dataType;if("socialDistancing"in e&&this.setState({current:t.socialDistancing.includes("current"),worst_effort:t.socialDistancing.includes("worst_effort"),best_effort:t.socialDistancing.includes("best_effort")},(function(){a.reloadAll()})),"models"in e)this.setState({models:e.models},(function(){a.reloadAll()}));else{var r=this.state.areas,n=t.areas,i=n.filter((function(e){return!r.includes(e)})),o=r.filter((function(e){return!n.includes(e)}));i.forEach(this.addAreaByStr),o.forEach(this.removeAreaByStr)}}},{key:"onDaysToPredictChange",value:function(e){var t=this;this.state.areas;this.setState({days:e},(function(){t.reloadAll()}))}},{key:"reloadAll",value:function(){var e=this,t=this.state.areas;this.setState({areas:[],mainGraphData:{}},(function(){t.forEach(e.addAreaByStr),e.state.dynamicMapOn&&0!==e.state.models.length&&e.map.fetchData(e.state.dynamicMapOn)}))}},{key:"switchDynamicMap",value:function(e){this.setState({dynamicMapOn:e}),this.map.fetchData(e)}},{key:"render",value:function(){var e=this,t=this.state,a=t.areas,r=t.areasList,i=t.models,o=t.modelsList,s=t.days,c=t.mainGraphData,l=t.dynamicMapOn,u=t.dataType,k=t.statistic,D=t.mapShown,w=t.yScale,C=t.noDataError,O=t.errorDescription,M=t.max_val,I=t.max_death_val,j=this.generateMarks(),x=this.getDaysToFirstDate(),A=r.filter((function(t){return!e.areaIsSelected(t)})).map(B).sort().map((function(e){return n.a.createElement($,{key:e}," ",e," ")})),N=o.filter((function(t){return!e.modelIsSelected(t)})).map((function(e){return n.a.createElement($,{key:e.name,value:e.name},n.a.createElement(E.a,{title:e.description,placement:"right"},e.name))})),R={area:n.a.createElement("p",{className:"instruction"},"Select the areas by clicking on the map or searching in this input box."),model:n.a.createElement("div",{className:"instruction horizontal"},n.a.createElement("p",{className:"instruction horizontal"},'Our model produces forecasts for multiple under-reported positive cases options. For example, "SI-kJalpha - 20x " denotes the assumption that the under-reported positive cases are 20 times of the current reported cases. For modeling details, please see: ',n.a.createElement("a",{href:"https://arxiv.org/abs/2004.11372",target:"blank"},"https://arxiv.org/abs/2004.11372"),".")),date:n.a.createElement("p",{className:"instruction horizontal"},"Predictions up to the date selected will be shown."),socialDistancing:n.a.createElement("p",{className:"instruction horizontal"},"Please select one of the three social distancing scenarios."),data_type:n.a.createElement("p",{className:"instruction horizontal"},"Select the forecasts for cumulative infections or deaths."),statistics:n.a.createElement("p",{className:"instruction horizontal"},"Switch between cumulative view or incident view."),scale:n.a.createElement("p",{className:"instruction horizontal"},"Switch between linear view or logarithmic view.")},T={dynamicMap:n.a.createElement("p",{className:"instruction vertical"},"Enable the map to dynamically change to reflect the prediction. Note that this functionality is not yet perfect and the reaction time may be slow depending on your machine."),radioGroup:n.a.createElement("p",{className:"instruction vertical"},"Switch between cumulative infection view or death view on the heatmap.")},V="";if(0!=this.state.totalConfirmed&&0!=this.state.totalDeaths){var F=new Date,L=String(F.getDate()).padStart(2,"0");V="By "+String(F.getMonth()+1).padStart(2,"0")+"/"+L+"/"+F.getFullYear()+", "+this.state.totalConfirmed.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" people around the world have been tested positive, and "+this.state.totalDeaths.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" people have died of Covid-19."}for(var G="",W="",H=i.length-1;H>=0;H--){if("SI-kJalpha"===i[H].substring(0,10)){G=i[H],0===W.length&&(W=i[H]+" (death prediction)");break}W=i[H]}return n.a.createElement("div",{className:"covid-19-predict"},n.a.createElement(f.a,{type:"flex",justify:"space-around"},C?n.a.createElement(S.a,{message:"".concat(O),description:"Please wait for our updates.",type:"error",closable:!0,onClose:this.onAlertClose}):null,n.a.createElement(h.a,{span:10},n.a.createElement(f.a,null,n.a.createElement("div",{className:"form-wrapper"},n.a.createElement(y.a,{ref:this.formRef,onValuesChange:this.onValuesChange,initialValues:{areas:a,models:i,days:14,socialDistancing:["current"]}},n.a.createElement(b.a,{content:R.area,placement:"right",visible:this.state.showControlInstructions},n.a.createElement(y.a.Item,{label:"Areas",name:"areas",rules:[{required:!0,message:"Please select areas!"}]},n.a.createElement(_.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Areas"},A))),n.a.createElement(b.a,{content:R.model,placement:"right",visible:this.state.showControlInstructions},n.a.createElement(y.a.Item,{label:"Models:",name:"models",rules:[{required:!0,message:"Please select a prediction model!"}]},n.a.createElement(_.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Prediction Models"},N))),n.a.createElement(b.a,{content:R.date,placement:"right",visible:this.state.showControlInstructions},n.a.createElement(y.a.Item,{label:"Date to Predict",name:"days",rules:[{required:!0,message:"Please select number of days!"}]},n.a.createElement(g.a,{marks:j,min:s-30>=-x?s-30:-x,initialValue:s,max:s+50<=99?s+50:99,onAfterChange:this.onDaysToPredictChange,step:null}))),n.a.createElement(b.a,{content:R.socialDistancing,placement:"right",visible:this.state.showControlInstructions},n.a.createElement(y.a.Item,{label:"Social Distancing",name:"socialDistancing"},n.a.createElement(v.a.Group,{style:{width:"100%"}},n.a.createElement(f.a,null,n.a.createElement(v.a,{defaultChecked:!0,value:"current"},"Current Trend"),n.a.createElement(v.a,{value:"worst_effort"},"Worst Distancing Effort"),n.a.createElement(v.a,{value:"best_effort"},"Best Distancing Effort")))))),n.a.createElement(y.a,null,n.a.createElement(b.a,{content:R.data_type,placement:"right",visible:this.state.showControlInstructions},n.a.createElement(y.a.Item,null,"Data Type:\xa0\xa0",n.a.createElement(v.a.Group,{defaultValue:["confirmed"],onChange:this.handleDataTypeSelect},n.a.createElement(v.a,{defaultChecked:!0,value:"confirmed"},"Confirmed Cases"),n.a.createElement(v.a,{value:"death"},"Deaths")))),n.a.createElement(b.a,{content:R.statistics,placement:"right",visible:this.state.showControlInstructions},n.a.createElement(y.a.Item,null,"Statistic:\xa0\xa0",n.a.createElement(p.a.Group,{value:k,onChange:this.handleStatisticSelect},n.a.createElement(p.a,{value:"cumulative"},"Cumulative Cases"),n.a.createElement(p.a,{value:"delta"},"New Cases")))),n.a.createElement(b.a,{content:R.scale,placement:"right",visible:this.state.showControlInstructions},n.a.createElement(y.a.Item,null,"Scale:\xa0\xa0",n.a.createElement(p.a.Group,{value:w,onChange:this.handleYScaleSelect},n.a.createElement(p.a,{value:"linear"},"linear"),n.a.createElement(p.a,{value:"log"},"logarithmic"))))))),a.length?n.a.createElement(f.a,null,n.a.createElement("div",{className:"graph-wrapper"},n.a.createElement(P,{data:c,dataType:u,onNoData:this.onNoData,statistic:k,yScale:w}))):null),n.a.createElement(h.a,{span:12},n.a.createElement(f.a,null,n.a.createElement("p",{className:"overview"},V)),n.a.createElement(f.a,null,n.a.createElement("span",{className:"map-control"},n.a.createElement(b.a,{content:T.dynamicMap,placement:"bottom",visible:this.state.showMapInstructions},"Dynamic Map:\xa0\xa0",n.a.createElement(m.a,{onChange:this.switchDynamicMap}))),n.a.createElement("span",{className:"map-control"},n.a.createElement(b.a,{content:T.radioGroup,placement:"bottom",visible:this.state.showMapInstructions},n.a.createElement(p.a.Group,{value:D,onChange:this.handleMapShownSelect},n.a.createElement(p.a,{value:"confirmed"},"Show Confirmed Cases"),n.a.createElement(p.a,{value:"death"},"Show Deaths"))))),n.a.createElement(f.a,null,n.a.createElement("div",{className:"map-wrapper"},n.a.createElement(Q,{className:"map",triggerRef:this.bindRef,dynamicMapOn:l,days:s,confirmed_model:G,death_model:W,onMapClick:this.onMapClick,onNoData:this.onNoData,statistic:k,dataType:D}))),n.a.createElement(f.a,null,n.a.createElement("div",{className:"color-legend"},n.a.createElement("div",{className:"number"}," 0 "),n.a.createElement("div",{className:"box_1"}),n.a.createElement("div",{className:"box_2"}),n.a.createElement("div",{className:"box_3"}),n.a.createElement("div",{className:"box_4"}),n.a.createElement("div",{className:"box_5"}),n.a.createElement("div",{className:"box_6"}),n.a.createElement("div",{className:"box_7"}),n.a.createElement("div",{className:"box_8"}),n.a.createElement("div",{className:"box_9"}),n.a.createElement("div",{className:"box_10"}),n.a.createElement("div",{className:"box_11"}),n.a.createElement("div",{className:"box_12"}),n.a.createElement("div",{className:"box_13"}),n.a.createElement("div",{className:"box_14"}),n.a.createElement("div",{className:"box_15"}),n.a.createElement("div",{className:"box_16"}),n.a.createElement("div",{className:"box_17"}),n.a.createElement("div",{className:"box_18"}),n.a.createElement("div",{className:"box_19"}),n.a.createElement("div",{className:"box_20"}),n.a.createElement("div",{className:"box_21"}),n.a.createElement("div",{className:"box_22"}),n.a.createElement("div",{className:"box_23"}),n.a.createElement("div",{className:"box_24"}),n.a.createElement("div",{className:"number"}," ","".concat("confirmed"===D?M:I)))),n.a.createElement(f.a,null,n.a.createElement("div",{className:"instruction-buttons-wrapper"},n.a.createElement(d.a,{className:"instruction-button",onClick:this.toggleControlInstructions},0==this.state.showControlInstructions?"Help with controls":"Close control instructions"),n.a.createElement(d.a,{className:"instruction-button",onClick:this.toggleMapInstructions},0==this.state.showMapInstructions?"Help with the map":"Close map instructions"))))))}}]),a}(r.PureComponent),ee=(a(921),a(435),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{className:"page-wrapper"},n.a.createElement("div",{className:"article"},n.a.createElement("h1",{className:"article-title"},"ReCOVER: Accurate Predictions and Resource Management for COVID-19 Epidemic Response"),n.a.createElement("p",{className:"article-paragraph"},"Accurate forecasts of COVID-19 is central to resource management and building strategies to deal with the epidemic. This is an NSF-funded project on COVID-19 forecasting led by by ",n.a.createElement("a",{className:"article-anchor",href:"https://sites.usc.edu/prasanna/"}," Viktor K. Prasanna ")," and ",n.a.createElement("a",{className:"article-anchor",href:"http://www-scf.usc.edu/~ajiteshs/"}," Ajitesh Srivastava "),"from the ",n.a.createElement("a",{className:"article-anchor",href:"https://dslab.usc.edu/"}," Data Science Lab ")," at the University of Southern California."),n.a.createElement("h2",null,"Our Approach"),n.a.createElement("p",{className:"article-paragraph"},"We use our own epidemic model called ",n.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2007.05180"}," SI-kJalpha"),", preliminary version of which we have successfully used during ",n.a.createElement("a",{className:"article-anchor",href:"https://news.usc.edu/83180/usc-engineers-earn-national-recognition-for-predicting-disease-outbreaks/",target:"_blank"},"DARPA Grand Challenge 2014"),". Our forecast appears on the official ",n.a.createElement("a",{className:"article-anchor",href:"https://www.cdc.gov/coronavirus/2019-ncov/covid-data/forecasting-us.html"}," CDC webpage"),". Our model can consider the effect of many complexities of the epidemic process and yet be simplified to a few parameters that are learned using fast linear regressions. Therefore, our approach can learn and generate forecasts extremely quickly. On a 2 core desktop machine, our approach takes only 3.18s to tune hyper-parameters, learn parameters and generate 100 days of forecasts of reported cases and deaths for all the states in the US. The total execution time for 184 countries is 11.83s and for more than 3000 US counties is 101.03s. Despite being fast, the accuracy of our forecasts is on par with the state-of-the-art as demonstrated on the ",n.a.createElement("a",{className:"article-anchor",href:"https://scc-usc.github.io/ReCOVER-COVID-19/#/leaderboard"}," leaderboard page"),". Details of modeling and comparisons can be found in ",n.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2007.05180"}," our paper"),". This work is supported by National Science Foundation Award No. 2027007 (RAPID)"),n.a.createElement("p",{className:"article-paragraph"},"The ",n.a.createElement("a",{className:"article-anchor",href:"https://github.com/scc-usc/ReCOVER-COVID-19",target:"_blank"}," Github repository ")," for this project is publicly available."),n.a.createElement("p",{className:"article-paragraph"},"The matlab code for forecasting is also made available on ",n.a.createElement("a",{className:"article-anchor",href:"https://www.mathworks.com/matlabcentral/fileexchange/75281-recover",target:"_blank"},"File Exchange"),". For the latest code, please see the Github repo."),n.a.createElement("p",{className:"article-paragraph"}," The code of the prediction model and this web application is contributed by Ajitesh Srivastava, Jamin Chen, Frost Tianjian Xu,  and Bob Xiaochen Yang. "),n.a.createElement("h2",null,"Related Papers"),n.a.createElement("ol",{className:"article-paragraph"},n.a.createElement("li",null,"Ajitesh Srivastava, Tianjian Xu and Viktor K. Prasanna,",n.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2007.05180",target:"_blank"},' "Fast and Accurate Forecasting of COVID-19 Deaths using the SIkJalpha Model"')," [arXiv]."),n.a.createElement("li",null,"Ajitesh Srivastava and Viktor K. Prasanna,",n.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2006.02127",target:"_blank"},' "Data-driven Identification of Number of Unreported Cases for COVID-19: Bounds and Limitations"')," [arXiv]. Accepted at KDD 2020."),n.a.createElement("li",null,"Ajitesh Srivastava and Viktor K. Prasanna,",n.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2004.11372",target:"_blank"},' "Learning to Forecast and Forecasting to Learn from the COVID-19 Pandemic"')," [arXiv].")),n.a.createElement("h2",null,"Other Links"),n.a.createElement("ol",{className:"article-paragraph"},n.a.createElement("li",null,n.a.createElement("a",{className:"article-anchor",href:"https://www.youtube.com/watch?v=ll6k8wlxOFo",target:"_blank"},"Webinar ")," describing our intial approach.")),n.a.createElement("h2",null,"USC Data Science Lab"),n.a.createElement("p",{className:"article-paragraph"},"The USC Data Science Lab focuses on applying machine learning, data mining, and network analysis to real-world problems in society and industry. Please find more information and other research projects ",n.a.createElement("a",{className:"article-anchor",href:"https://sites.usc.edu/dslab/",target:"_blank"}," on our website"),".")))}}]),a}(r.Component));var te=function(e){var t=e.series,a=e.lineGenerator,r=e.xScale,i=e.yScale;return t.map((function(e){var t=e.id,o=e.data,s=e.color,c=e.predicted,l=e.distancing,u={strokeWidth:5};return c&&(u.strokeDasharray=l?"6, 4":"2, 6"),n.a.createElement("path",{key:t,d:a(o.map((function(e){return{x:r(e.data.x),y:i(e.data.y)}}))),fill:"none",stroke:s,style:u})}))},ae={axis:{ticks:{text:{fontSize:18}},legend:{text:{fontSize:18}}},legends:{text:{fontSize:18}}},re=(r.Component,a(114));var ne=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).parseData=function(e,t){var a=Object.keys(e)[0];if(e[a])return"reproduction"===t?e[a].observed_rt.map((function(t,a){var r={name:t.date.split("-")[1]+"/"+t.date.split("-")[2]};r[Object.keys(e)[0]]=t.value,r["error".concat(Object.keys(e)[0])]=t.conf;for(var n=1;n<Object.keys(e).length;++n)r[Object.keys(e)[n]]=e[Object.keys(e)[n]].observed_rt[a].value,r["error".concat(Object.keys(e)[n])]=e[Object.keys(e)[n]].observed_rt[a].conf;return r})):e[a].observed_mrf.map((function(t,a){var r={name:t.date.split("-")[1]+"/"+t.date.split("-")[2]};r[Object.keys(e)[0]]=t.value,r["error".concat(Object.keys(e)[0])]=t.conf;for(var n=1;n<Object.keys(e).length;++n)r[Object.keys(e)[n]]=e[Object.keys(e)[n]].observed_mrf[a].value,r["error".concat(Object.keys(e)[n])]=e[Object.keys(e)[n]].observed_mrf[a].conf;return r}))},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.date,r=e.scoreType,i=this.parseData(t,r),o=Object.keys(t),s=[];o.map((function(e,t){var a=function(e){var t=[N.red,N.gold,N.lime,N.cyan,N.geekblue,N.purple,N.magenta];return t[e%t.length]}(t);return s.push(a),0}));for(var c=[],l=0;l<o.length;++l)c.push(n.a.createElement(re.e,{type:"monotone",key:l,dataKey:o[l],stroke:s[l][3],strokeWidth:5},n.a.createElement(re.b,{dataKey:"error".concat(o[l]),width:15,strokeWidth:2,stroke:s[l][6],direction:"y"})));return n.a.createElement(re.f,{width:1400,height:300,data:i,margin:{top:40,right:30,left:40,bottom:5}},n.a.createElement(re.a,{strokeDasharray:"3 3"}),n.a.createElement(re.i,{dataKey:"name"}),n.a.createElement(re.j,null,"reproduction"===r?n.a.createElement(re.c,{value:"Dynamic Reproduction Number",dy:90,position:"insideLeft",angle:-90,fontSize:15}):n.a.createElement(re.c,{value:"MFR Score",dy:45,position:"insideLeft",angle:-90,fontSize:15})),n.a.createElement(re.h,null),n.a.createElement(re.g,{x:a,stroke:"green",strokeWidth:5,fontSize:20,label:{position:"top",value:"selected date",fill:"green",fontSize:15},strokeDasharray:"10 10"}),"reproduction"===r?n.a.createElement(re.g,{y:1,stroke:"SandyBrown",strokeWidth:5,strokeDasharray:"3 3",label:{position:"left",value:"",fill:"red",fontSize:20}}):null,n.a.createElement(re.d,{iconSize:40}),c)}}]),a}(r.Component);H.e(X.a);var ie=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.call(this)).onShowState=function(t){e.setState({showState:t})},e.modelAPI=new G,e.state={areasList:[],showState:!1,worldSeries:{},usaSeries:{}},e.modelAPI.areas((function(t){return e.setState({areasList:t})})),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.triggerRef(this)}},{key:"fetchData",value:function(){var e=this,t=arguments,a=this.props.scoreType;t[0]?"reproduction"===a?this.modelAPI.scores_all({weeks:this.props.weeks},(function(a){var r=a.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area}}));t[1]?e.setState({heatmapData:r},e.initChart):e.setState({heatmapData:r},e.updateChart)})):this.modelAPI.all_mrf_scores({weeks:this.props.weeks},(function(a){var r=a.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area}}));t[1]?e.setState({heatmapData:r},e.initChart):e.setState({heatmapData:r},e.updateChart)})):"reproduction"===a?this.modelAPI.scores_all({weeks:this.props.latestWeek},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area,conf:e.conf}}));e.setState({heatmapData:a},e.initChart)})):this.modelAPI.all_mrf_scores({weeks:this.props.latestWeek},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area,conf:e.conf}}));e.setState({heatmapData:a},e.initChart)}))}},{key:"initChart",value:function(){this.chart=H.d("chartdiv",z.a),this.chart.projection=new z.d.Mercator;var e=this.chart.series.push(new z.b);e=this.createChartSeries(e,{geodata:U.a,exclude:["AQ"],data:this.state.heatmapData});var t=this.chart.series.push(new z.b);t=this.createChartSeries(t,{geodata:Y.a,data:this.state.heatmapData,disabled:!this.state.showState}),this.stateSeries=[t],this.initChartInterface(),this.setState({worldSeries:e,usaSeries:t})}},{key:"updateChart",value:function(){var e=this.state.worldSeries,t=this.state.usaSeries;e.data=this.state.heatmapData,t.data=this.state.heatmapData}},{key:"createChartSeries",value:function(e,t){var a=this.props.scoreType,r=(e=Object.assign(e,t)).mapPolygons.template;"reproduction"===a?e.heatRules.push({property:"fill",target:r,min:H.c("#85DB50"),max:H.c("#F33A21"),minValue:0,maxValue:4}):e.heatRules.push({property:"fill",target:r,min:H.c("#85DB50"),max:H.c("#F33A21"),minValue:0,maxValue:.4}),r.tooltipText="{name}: {value}",r.nonScalingStroke=!0,r.strokeWidth=.5,r.states.create("hover").properties.fill=H.c("#83FE00"),r.cursorOverStyle=H.b.pointer;var n=this.props,i=n.onMapClick,o=n.onNoData;return r.events.on("hit",(function(e){var t=e.target.dataItem.dataContext,a=(t.id,t.value,t.area),r=t.name;a?i(a):o(r)})),e}},{key:"initChartInterface",value:function(){var e=this,t=this.state.showState;this.chart.zoomControl=new z.c,this.chart.zoomControl.cursorOverStyle=H.b.pointer;var a=this.chart.chartContainer.createChild(H.a);a.label.text="".concat(t?"Hide":"Show"," States/Provinces"),a.togglable=!0,a.padding(5,5,5,5),a.align="right",a.marginRight=15,a.cursorOverStyle=H.b.pointer,a.events.on("hit",(function(){e.onShowState(a.isActive);var t=e.state.showState;e.stateSeries.forEach((function(e){return e.disabled=!t})),a.label.text="".concat(t?"Hide":"Show"," States/Provinces")}))}},{key:"componentWillUnmount",value:function(){this.chart&&this.chart.dispose()}},{key:"render",value:function(){return n.a.createElement("div",{id:"chartdiv"})}}]),a}(r.Component),oe=(a(1003),_.a.Option),se=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).componentDidMount=function(){r.formRef=n.a.createRef(),r.modelAPI=new G,r.modelAPI.latest_score_date((function(e){return r.setState({latestDate:e[0].date,weeks:e[0].weeks,latestWeek:e[0].weeks,firstDate:e[0].firstDate},(function(){r.addAreaByStr("US"),r.formRef.current.setFieldsValue({weeks:r.state.latestWeek}),r.map.fetchData(r.state.dynamicMapOn)}))})),r.modelAPI.areas((function(e){return r.setState({areasList:e})}))},r.bindRef=function(e){r.map=e},r.onAlertClose=function(){r.setState({noDataError:!1})},r.onNoData=function(e){r.setState({noDataError:!0,errorDescription:"There is currently no data for ".concat(e)})},r.generateMarks=function(){var e=r.state,t=e.weeks,a=(e.lastDate,e.latestWeek),n=e.firstDate,i=new Date("".concat(n,"T00:00"));i.setDate(i.getDate(Date)+7*t);for(var o={},s=0;s<=5&&t+s<=a;)o[t+s]="".concat(i.getMonth()+1,"/").concat(i.getDate()),i.setDate(i.getDate(Date)+7),s++;for(s=1,(i=new Date("".concat(n,"T00:00"))).setDate(i.getDate(Date)+7*(t-1));s<=5&&t-s>=0;)o[t-s]="".concat(i.getMonth()+1,"/").concat(i.getDate()),i.setDate(i.getDate(Date)-7),s++;return(i=new Date("".concat(n,"T00:00"))).setDate(i.getDate(Date)+7*t),[i,o]},r.handleScoreTypeSelect=function(e){r.setState({scoreType:e.target.value},(function(){r.map.fetchData(r.state.dynamicMapOn,!0)}))},r.state={areas:r.props.areas||[],areasList:[],latestDate:"",firstDate:"",mainGraphData:{},weeks:r.props.weeks||0,latestWeek:0,dynamicMapOn:!1,noDataError:!1,errorDescription:"",scoreType:"reproduction"},r.addAreaByStr=r.addAreaByStr.bind(Object(C.a)(r)),r.removeAreaByStr=r.removeAreaByStr.bind(Object(C.a)(r)),r.onValuesChange=r.onValuesChange.bind(Object(C.a)(r)),r.onMapClick=r.onMapClick.bind(Object(C.a)(r)),r.onWeeksChange=r.onWeeksChange.bind(Object(C.a)(r)),r.switchDynamicMap=r.switchDynamicMap.bind(Object(C.a)(r)),r.onAlertClose=r.onAlertClose.bind(Object(C.a)(r)),r.onNoData=r.onNoData.bind(Object(C.a)(r)),r.generateMarks=r.generateMarks.bind(Object(C.a)(r)),r.handleScoreTypeSelect=r.handleScoreTypeSelect.bind(Object(C.a)(r)),r}return Object(c.a)(a,[{key:"onMapClick",value:function(e){this.areaIsSelected(e)||this.addAreaByStr(B(e))}},{key:"areaIsSelected",value:function(e){if(this.state.areas&&e){var t=B(e);return this.state.areas.includes(t)}return!1}},{key:"addAreaByStr",value:function(e){var t=this,a=W(e);this.setState((function(t){return{areas:[].concat(Object(w.a)(t.areas),[e])}}),(function(){t.modelAPI.scores({state:a.state,country:a.country,weeks:t.state.latestWeek},(function(a){t.setState((function(t){return{mainGraphData:Object(D.a)({},t.mainGraphData,Object(k.a)({},e,a))}}))})),t.formRef.current.setFieldsValue({areas:t.state.areas})}))}},{key:"removeAreaByStr",value:function(e){this.setState((function(t){return{areas:t.areas.filter((function(t){return t!==e})),mainGraphData:Object.keys(t.mainGraphData).filter((function(t){return t!==e})).reduce((function(e,a){return Object(D.a)({},e,Object(k.a)({},a,t.mainGraphData[a]))}),{})}}))}},{key:"onValuesChange",value:function(e,t){var a=this.state.areas,r=t.areas;if(r&&a){var n=r.filter((function(e){return!a.includes(e)})),i=a.filter((function(e){return!r.includes(e)}));n.forEach(this.addAreaByStr),i.forEach(this.removeAreaByStr)}}},{key:"onWeeksChange",value:function(e){var t=this;this.setState({weeks:e},(function(){t.state.dynamicMapOn&&t.map.fetchData(t.state.dynamicMapOn)}))}},{key:"switchDynamicMap",value:function(e){this.setState({dynamicMapOn:e}),this.map.fetchData(e)}},{key:"render",value:function(){var e=this,t=this.state,a=t.areas,r=t.areasList,i=t.weeks,o=t.mainGraphData,s=t.dynamicMapOn,c=t.latestWeek,l=t.noDataError,u=t.errorDescription,d=t.scoreType,v=r.filter((function(t){return!e.areaIsSelected(t)})).map(B).sort().map((function(e){return n.a.createElement(oe,{key:e}," ",e," ")})),b=this.generateMarks(),E=Object(O.a)(b,2),k=E[0],D=E[1],w=k.getMonth()+1<10?"0".concat(k.getMonth()+1):k.getMonth()+1,C=k.getDate()<10?"0".concat(k.getDate()):k.getDate(),M="".concat(w,"/").concat(C);return n.a.createElement("div",{className:"score-page"},n.a.createElement(f.a,{type:"flex",justify:"space-around"},n.a.createElement(h.a,{span:10},l?n.a.createElement(S.a,{message:"".concat(u),description:"Please wait for our updates.",type:"error",closable:!0,onClose:this.onAlertClose}):null,n.a.createElement("div",{className:"form-wrapper"},n.a.createElement(y.a,{ref:this.formRef,onValuesChange:this.onValuesChange},n.a.createElement(y.a.Item,{label:"Areas",name:"areas",rules:[{required:!0,message:"Please select areas!"}]},n.a.createElement(_.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Areas"},v)),n.a.createElement(y.a.Item,{label:"Week to check",name:"weeks",rules:[{required:!0,message:"Please select the week you want to see"}]},n.a.createElement(g.a,{marks:D,initialValue:i,min:i-5>=0?i-5:0,max:i+5<=c?i+5:c,onAfterChange:this.onWeeksChange}))),n.a.createElement("div",{className:"radio-group"},"Data Type:\xa0\xa0",n.a.createElement(p.a.Group,{value:d,onChange:this.handleScoreTypeSelect},n.a.createElement(p.a,{value:"reproduction"},"Dynamic Reproduction Number"),n.a.createElement(p.a,{value:"mfr"},"Model-based Fatality Rate"))),n.a.createElement("p",null,"Dynamic Map:\xa0\xa0",n.a.createElement(m.a,{onChange:this.switchDynamicMap})))),n.a.createElement(h.a,{span:14},n.a.createElement("div",{className:"map-wrapper"},n.a.createElement(ie,{className:"score-map",triggerRef:this.bindRef,dynamicMapOn:s,weeks:i,latestWeek:c,onMapClick:this.onMapClick,onNoData:this.onNoData,scoreType:d})))),a.length?n.a.createElement(f.a,null,n.a.createElement(h.a,{span:24},n.a.createElement("div",{className:"graph-wrapper"},n.a.createElement(ne,{data:o,date:M,scoreType:d})))):null)}}]),a}(r.PureComponent),ce=a(611),le=a(70),ue=(a(1004),a(223)),de=(a(1006),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).handleItemClick=function(e){var t=r.props,a=t.redirectForecast,n=t.redirectAbout,i=t.redirectScore,o=t.redirectLeaderboard,s=t.redirectHighlights,c=e.key;r.setState({activeItem:e.key}),"forecast"===c?a():"information"===c?n():"quarantine-score"===c?i():"leaderboard"===c?o():"highlights"===c&&s()},r.state={activateItem:"forecast"},r}return Object(c.a)(a,[{key:"render",value:function(){var e=window.location.href;return n.a.createElement(f.a,{className:"navbar-container"},n.a.createElement(h.a,null,n.a.createElement("img",{className:"logo",src:"https://identity.usc.edu/files/2011/12/combo_gold_white_cardinal.png",alt:"USC"})),n.a.createElement(h.a,null,n.a.createElement(ue.a,{theme:"light",mode:"horizontal",onClick:this.handleItemClick,defaultSelectedKeys:e.includes("score")?["quarantine-score"]:e.includes("about")?["information"]:e.includes("leaderboard")?["leaderboard"]:e.includes("highlights")?["highlights"]:["forecast"]},n.a.createElement(ue.a.Item,{key:"forecast"},"COVID-19 Forecast"),n.a.createElement(ue.a.Item,{key:"quarantine-score"},"Reproduction Number"),n.a.createElement(ue.a.Item,{key:"highlights"},"Highlights"),n.a.createElement(ue.a.Item,{key:"leaderboard"},"Leaderboard"),n.a.createElement(ue.a.Item,{key:"information"},"About Us"))))}}]),a}(r.Component)),me=(a(1013),a(1084),a(224)),he=(a(1017),a(606)),pe=(a(1019),a(1020),a(1021),a(1022),a(605)),fe=a.n(pe),ve={jhu:{runningAvgRankings:[{model:{name:"YYG_ParamSearch",description:"Based on the SEIR model to make daily projections regarding COVID-19 infections and deaths in 50 US states. The model's contributor is Youyang Gu.",link:"http://covid19-projections.com/about/"},RMSE:34.35},{model:{name:"SIkJa_USC",description:"This is our SI-kJalpha model.",link:"https://scc-usc.github.io/ReCOVER-COVID-19/"},RMSE:35.41},{model:{name:"UCLA_SuEIR",description:"SEIR model by UCLA Statistical Machine Learning Lab.",link:"https://covid19.uclaml.org/"},RMSE:52.53},{model:{name:"Covid19Sim_Simulator",description:"An interactive tool developed by researchers at Mass General Hospital, Harvard Medical School, Georgia Tech and Boston Medical Center.",link:"https://covid19sim.org/"},RMSE:58.28},{model:{name:"CU_select",description:"A metapopulation county-level SEIR model by Columbia University.",link:"https://blogs.cuit.columbia.edu/jls106/publications/covid-19-findings-simulations/"},RMSE:64.22},{model:{name:"JHU_IDD_CovidSP",description:"County-level metapopulation model by Johns Hopkins ID Dynamics COVID-19 Working Group.",link:"https://github.com/HopkinsIDD/COVIDScenarioPipeline"},RMSE:72.68},{model:{name:"IowaStateLW_STEM",description:"A COVID19 forecast project led by Lily Wang in Iowa State University.",link:"https://covid19.stat.iastate.edu"},RMSE:76.08},{model:{name:"CovidActNow_SEIR_CAN",description:"SEIR model by the CovidActNow research team.",link:"https://covidactnow.org/"},RMSE:110.82}],recentRankings:[{model:{name:"YYG_ParamSearch",description:"Based on the SEIR model to make daily projections regarding COVID-19 infections and deaths in 50 US states. The model's contributor is Youyang Gu.",link:"http://covid19-projections.com/about/"},RMSE:18.6},{model:{name:"SIkJa_USC",description:"This is our SI-kJalpha model.",link:"https://scc-usc.github.io/ReCOVER-COVID-19/"},RMSE:20.03},{model:{name:"Covid19Sim_Simulator",description:"An interactive tool developed by researchers at Mass General Hospital, Harvard Medical School, Georgia Tech and Boston Medical Center.",link:"https://covid19sim.org/"},RMSE:20.58},{model:{name:"JHU_IDD_CovidSP",description:"County-level metapopulation model by Johns Hopkins ID Dynamics COVID-19 Working Group.",link:"https://github.com/HopkinsIDD/COVIDScenarioPipeline"},RMSE:24.22},{model:{name:"UCLA_SuEIR",description:"SEIR model by UCLA Statistical Machine Learning Lab.",link:"https://covid19.uclaml.org/"},RMSE:24.6},{model:{name:"CU_select",description:"A metapopulation county-level SEIR model by Columbia University.",link:"https://blogs.cuit.columbia.edu/jls106/publications/covid-19-findings-simulations/"},RMSE:40.24},{model:{name:"IowaStateLW_STEM",description:"A COVID19 forecast project led by Lily Wang in Iowa State University.",link:"https://covid19.stat.iastate.edu"},RMSE:40.41},{model:{name:"CovidActNow_SEIR_CAN",description:"SEIR model by the CovidActNow research team.",link:"https://covidactnow.org/"},RMSE:NaN}]}},ge=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"getAvatar",value:function(e){var t="";switch(e){case 1:t="https://img.icons8.com/officel/80/000000/medal2.png";break;case 2:t="https://img.icons8.com/officel/80/000000/medal-second-place.png";break;case 3:t="https://img.icons8.com/officel/80/000000/medal2-third-place.png";break;default:t="https://img.icons8.com/carbon-copy/100/000000/"+e+"-circle.png"}return n.a.createElement(he.a,{className:"rank-number",src:t,alt:""})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"page-wrapper"},n.a.createElement("div",{className:"grid"},n.a.createElement(f.a,null,n.a.createElement(h.a,{span:12},n.a.createElement("h2",{className:"title"},"Running Average Performance"),n.a.createElement(me.a,{className:"leaderboard",itemLayout:"horizontal",dataSource:ve.jhu.runningAvgRankings,renderItem:function(t){return n.a.createElement(me.a.Item,null,n.a.createElement(me.a.Item.Meta,{avatar:e.getAvatar(ve.jhu.runningAvgRankings.indexOf(t)+1),title:n.a.createElement("a",{className:"model-name",href:t.model.link},t.model.name),description:t.model.description}),n.a.createElement("div",{className:"content"},n.a.createElement("span",null,"RMSE: ",n.a.createElement("span",{className:"score"},t.RMSE))))}})),n.a.createElement(h.a,{span:12},n.a.createElement("h2",{className:"title"},"Recent Performance (from 2020-09-20)"),n.a.createElement(me.a,{className:"leaderboard",itemLayout:"horizontal",dataSource:ve.jhu.recentRankings,renderItem:function(t){return n.a.createElement(me.a.Item,null,n.a.createElement(me.a.Item.Meta,{avatar:e.getAvatar(ve.jhu.recentRankings.indexOf(t)+1),title:n.a.createElement("a",{className:"model-name",href:t.model.link},t.model.name),description:t.model.description}),n.a.createElement("div",{className:"content"},n.a.createElement("span",null,"RMSE: ",n.a.createElement("span",{className:"score"},t.RMSE))))}}))),n.a.createElement(f.a,null,n.a.createElement("div",{className:"main-graph-container"},n.a.createElement("img",{className:"graph",src:fe.a}))),n.a.createElement("p",{className:"clarification"},n.a.createElement("b",null,"Evaluation method:")," We have recently moved the evaluation to JHU dataset only as majority of the forecasting teams are now using it. ",n.a.createElement("br",null),"Our forecasts used here are taken from the our ",n.a.createElement("a",{href:"https://github.com/scc-usc/ReCOVER-COVID-19/tree/master/results/forecasts"}," github repo "),". The chosen evaluation metric is Root Mean Squared Error (RMSE) of weekly new deaths computed ",n.a.createElement("br",null),"over the next two weeks from the day of the forecasts. ",n.a.createElement("br",null),"Please contact us at ",n.a.createElement("a",{className:"article-anchor",href:"mailto:ajiteshs@usc.edu"},"ajiteshs@usc.edu"),"to add your model to the leaderboard."),n.a.createElement("p",{className:"disclaimer"},n.a.createElement("b",null,"Disclaimer:")," The above Covid-19 forecast reports may have copyright restrictions. You may visit the website of their original work by clicking on their model names. ",n.a.createElement("br",null),"All credits for predictions go to the respective owners of the forecast reports. The ReCover-Covid-19 website does not hold responsibility or liability for prediction accuracy of prediction reports that are not generated by USC Data Science lab.")))}}]),a}(r.Component),be=a(299),ye=(a(1067),a(609));function Se(e){var t=Object(r.useState)(null),a=Object(O.a)(t,2),i=a[0],o=a[1];function s(e){var t=e.numPages;o(t),document.querySelectorAll(".react-pdf__Page__textContent").forEach((function(e){var t=e.style;t.top="0",t.left="0",t.transform=""}))}var c=e.pdf;return n.a.createElement(ye.SizeMe,{monitorHeight:!0,refreshRate:128,refreshMode:"debounce",render:function(e){var t=e.size;return n.a.createElement("div",null,n.a.createElement(be.Document,{file:c,options:{workerSrc:"pdf.worker.js"},onLoadSuccess:s},Array.from(new Array(i),(function(e,a){return n.a.createElement(be.Page,{width:t.width,key:"page_".concat(a+1),pageNumber:a+1})}))))}})}be.pdfjs.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(be.pdfjs.version,"/pdf.worker.js");var Ee=a(610),ke=a.n(Ee),De=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).redirectForecast=function(){r.setState({redirectForecast:!0,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!1})},r.redirectAbout=function(){r.setState({redirectForecast:!1,redirectAbout:!0,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!1})},r.redirectScore=function(){r.setState({redirectForecast:!1,redirectAbout:!1,redirectScore:!0,redirectHighlights:!1,redirectLeaderboard:!1})},r.redirectLeaderboard=function(){r.setState({redirectForecast:!1,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!0,redirectHighlights:!1})},r.redirectHighlights=function(){r.setState({redirectForecast:!1,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!0})},r.state={redirectForecast:!1,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!1},r}return Object(c.a)(a,[{key:"render",value:function(){var e=this.state,t=e.redirectForecast,a=e.redirectAbout,r=e.redirectScore,i=e.redirectLeaderboard,o=e.redirectHighlights;return n.a.createElement(ce.a,{basename:"/"},t?n.a.createElement(le.a,{to:"/"}):null,o?n.a.createElement(le.a,{to:"/highlights"}):null,r?n.a.createElement(le.a,{to:"/score"}):null,a?n.a.createElement(le.a,{to:"/about"}):null,i?n.a.createElement(le.a,{to:"/leaderboard"}):null,n.a.createElement(de,{redirectForecast:this.redirectForecast,redirectHighlights:this.redirectHighlights,redirectScore:this.redirectScore,redirectAbout:this.redirectAbout,redirectLeaderboard:this.redirectLeaderboard}),n.a.createElement(le.d,null,n.a.createElement(le.b,{exact:!0,path:"/",render:function(e){return n.a.createElement(Z,e)}}),n.a.createElement(le.b,{exact:!0,path:"/score",render:function(e){return n.a.createElement(se,e)}}),n.a.createElement(le.b,{exact:!0,path:"/about",render:function(e){return n.a.createElement(ee,e)}}),n.a.createElement(le.b,{exact:!0,path:"/leaderboard",render:function(e){return n.a.createElement(ge,e)}}),n.a.createElement(le.b,{exact:!0,path:"/highlights"},n.a.createElement(Se,{pdf:ke.a}))))}}]),a}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(De,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},331:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=331},435:function(e,t,a){},605:function(e,t,a){e.exports=a.p+"static/media/all_graph.dfa8be3f.png"},610:function(e,t,a){e.exports=a.p+"static/media/highlights.03496ebc.pdf"},674:function(e,t,a){e.exports=a(1083)},679:function(e,t,a){},834:function(e,t,a){},921:function(e,t,a){}},[[674,1,3]]]);
//# sourceMappingURL=main.8abd6ffe.chunk.js.map